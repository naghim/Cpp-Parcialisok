#ifndef MALWARECATALOG_H
#define MALWARECATALOG_H

#include "malware.h"
#include <map>
#include <string>
#include <vector>

class MalwareCatalog
{
private:
	std::map<std::string, Malware *> catalog;

public:
	// malware hozzáadása (ha már létezik ilyen nevű malware → hibaüzenet, ne vedd fel kétszer)
	void addMalware(Malware *m);
	// keresés név szerint (ha már létezik → hibaüzenet)
	Malware *findByName(const std::string &name);
	// keresés típus szerint
	std::vector<Malware *> findByType(const std::string &type);
	// kataógus kiírása
	void printCatalog() const;
	// rendezés csökkenő sorrendben a veszélyességi szint alapján alapján(ahol a skála a következőt jelenti:10 a legveszélyesebb, 1 egyáltalán nem veszélyes)
	std::vector<std::pair<std::string, Malware *>> sortByThreatLevelDesc() const;

	// mivel dinamikusan foglalunk helyet a malware-eknek, ezért destruktorban felszabadítjuk őket
	~MalwareCatalog();
};

#endif
